<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Time Observer Emulator</title>
    <style>
        :root { --neon: #00ffcc; --danger: #ff3366; --gold: #ffea00; --bg: #05080a; }
        body { background: var(--bg); color: #e0e0e0; font-family: 'Segoe UI', monospace; margin: 0; padding: 10px; text-align: center; overflow-x: hidden; }
        
        .top-brand { color: var(--neon); font-size: 1.2rem; font-weight: bold; letter-spacing: 3px; margin-top: 10px; }
        .main-title { color: var(--gold); font-size: 1.5rem; font-weight: bold; margin: 15px 0; text-shadow: 0 0 10px var(--gold); line-height: 1.4; text-transform: uppercase; }

        .mic-control { background: #111; border: 1px solid #333; padding: 10px 20px; border-radius: 5px; display: inline-flex; align-items: center; gap: 15px; margin-bottom: 25px; }
        .mic-control input { width: 120px; cursor: pointer; accent-color: var(--danger); }
        .stat-label { color: var(--neon); font-size: 10px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }
        
        .red-label { color: var(--danger) !important; }

        .primary-layout { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 20px; 
            max-width: 1200px; 
            margin: 0 auto; 
        }

        .card { 
            background: linear-gradient(145deg, #0f1218, #1a1e26);
            border: 1px solid #333; 
            border-radius: 12px; 
            padding: 20px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex; 
            flex-direction: column; 
            align-items: center;
            flex: 1;
            min-width: 280px;
        }

        /* Enhanced 3D Bloch Sphere Styles */
        #bloch-stage { height: 140px; perspective: 1000px; display: flex; align-items: center; justify-content: center; }
        .sphere { 
            width: 90px; height: 90px; 
            border: 1px solid rgba(0, 255, 204, 0.3); 
            border-radius: 50%; 
            position: relative; 
            transform-style: preserve-3d; 
            transition: transform 0.1s linear; 
        }
        .sphere::before, .sphere::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            border-radius: 50%; border: 1px solid rgba(0, 255, 204, 0.2);
        }
        .sphere::before { transform: rotateY(90deg); }
        .sphere::after { transform: rotateX(90deg); border-style: dashed; }
        
        .needle { 
            width: 3px; height: 45px; 
            background: linear-gradient(to top, var(--gold), transparent); 
            position: absolute; left: 43.5px; top: 0; 
            transform-origin: bottom; 
            box-shadow: 0 0 15px var(--gold); 
        }

        .clock-wrap { width: 100%; text-align: left; background: rgba(0,0,0,0.4); padding: 12px; border-radius: 8px; border-left: 4px solid var(--neon); margin-bottom: 10px; }
        .clock { font-size: 2.2rem; font-weight: bold; color: #fff; font-family: 'Courier New'; }
        
        #wave-canvas { width: 100%; height: 120px; background: rgba(0,0,0,0.6); border-radius: 8px; border: 1px solid #222; margin-top: 10px; }

        /* Updated Table Section */
        .data-table-section { 
            width: 95%; max-width: 1100px; 
            background: rgba(15, 18, 24, 0.8); backdrop-filter: blur(10px);
            border: 1px solid #444; padding: 20px; border-radius: 15px; 
            margin: 30px auto; box-shadow: 0 0 40px rgba(0,0,0,0.8);
            overflow-x: auto;
        }
        table { width: 100%; border-collapse: separate; border-spacing: 0 8px; text-align: left; min-width: 600px; }
        th { color: var(--gold); padding: 12px; text-transform: uppercase; font-size: 11px; letter-spacing: 2px; border-bottom: 1px solid #333; }
        td { padding: 15px 12px; background: rgba(255,255,255,0.03); font-family: 'Courier New'; font-size: 1rem; color: #fff; }
        td:first-child { border-radius: 8px 0 0 8px; border-left: 2px solid var(--gold); }
        
        .noise-bar {
            max-width: 600px; margin: 25px auto; background: #0a0c10;
            border: 1px solid var(--neon); padding: 10px 30px; border-radius: 50px;
            display: flex; align-items: center; justify-content: center; gap: 20px;
        }
        .meter-container { height: 15px; width: 200px; background: #000; border: 1px solid #333; position: relative; border-radius: 10px; overflow: hidden; }
        #fill { position: absolute; left: 0; height: 100%; background: var(--neon); box-shadow: 0 0 10px var(--neon); transition: width 0.1s; width: 0%; }

        #rpm-val { font-size: 3rem; font-weight: bold; color: #fff; margin: 5px 0; font-family: 'Courier New'; text-shadow: 0 0 10px #fff; }

        #start-btn { 
            background: var(--danger); color: #fff; padding: 18px 70px; border-radius: 50px; 
            font-weight: bold; cursor: pointer; border: none; font-size: 1.2rem; letter-spacing: 4px;
            transition: all 0.4s ease; box-shadow: 0 0 15px rgba(255, 51, 102, 0.4); text-transform: uppercase;
        }
        #start-btn.active { background: #1a1a1a; color: var(--neon); border: 1px solid var(--neon); box-shadow: 0 0 30px var(--neon); }

        .watermark { color: rgba(255, 255, 255, 0.4); font-size: 12px; font-weight: bold; letter-spacing: 3px; margin-top: 50px; padding-bottom: 30px; text-transform: uppercase; }
    </style>
</head>
<body>

    <div class="top-brand">GROW-WIN</div>
    <div class="main-title">QUANTUM TIME OBSERVATION ON TIME - DILATION WITH WAVE - PARTICLE DUALITY</div>

    <div class="mic-control">
        <span class="stat-label">OUTPUT GAIN</span>
        <input type="range" id="sens-knob" min="0.5" max="10.0" step="0.1" value="2.0" oninput="document.getElementById('sens-val').innerText = this.value + 'x'">
        <span id="sens-val" style="color:var(--danger); font-weight:bold;">2.0x</span>
    </div>

    <div class="primary-layout">
        <div class="card">
            <span class="stat-label" style="font-size: 12px; margin-bottom: 5px;">ANGULAR VELOCITY <span class="red-label">(10<sup>6</sup> m/s)</span></span>
            <div id="rpm-val">000</div>
            <div id="bloch-stage">
                <div class="sphere" id="sphere"><div class="needle" id="needle"></div></div>
            </div>
            <span class="stat-label">QUANTUM PHASE OBSERVATION</span>
        </div>

        <div class="card">
            <span class="stat-label">TIME - DILATION <span class="red-label">(SECONDS)</span></span>
            <div class="clock-wrap">
                <small style="color:var(--neon)">ABSOLUTE TIME</small>
                <div class="clock" id="et">0.00</div>
            </div>
            <div class="clock-wrap" style="border-left-color:var(--gold)">
                <small style="color:var(--gold)">RELATIVE TIME</small>
                <div class="clock" id="st" style="color:var(--gold)">0.00</div>
            </div>
            <span class="stat-label" id="warp-factor">LORENTZ FACTOR: 1.000</span>
        </div>

        <div class="card">
            <span class="stat-label">WAVE - PARTICLE DUALITY</span>
            <canvas id="wave-canvas"></canvas>
            <span id="duality-status" class="stat-label" style="margin-top:15px; color:#fff; background: rgba(255,255,255,0.1); padding: 5px 15px; border-radius: 20px;">PARTICLE STATE</span>
        </div>
    </div>

    <div class="noise-bar">
        <span class="stat-label">SYSTEM NOISE</span>
        <div class="meter-container"><div id="fill"></div></div>
        <div id="db-label" style="font-size:1.1rem; font-weight:bold; color:var(--neon); min-width: 40px;">0%</div>
    </div>

    <div class="data-table-section">
        <span class="stat-label" style="margin-bottom: 15px; display: block; font-size: 12px;">COMPARATIVE SYSTEM STATUS & TIME DILATION</span>
        <table>
            <thead>
                <tr>
                    <th>TIME OBSERVATION</th>
                    <th>LIVE CLOCK</th>
                    <th>SYSTEM STATUS</th>
                    <th>TIME DILATION</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ABSOLUTE TIME</td>
                    <td id="table-et">0.00s</td>
                    <td style="color: var(--neon); letter-spacing: 1px;">STATIONARY</td>
                    <td>+0.00s</td>
                </tr>
                <tr>
                    <td>RELATIVE TIME</td>
                    <td id="table-st">0.00s</td>
                    <td id="table-status" style="color: var(--gold); letter-spacing: 1px;">IDLE</td>
                    <td id="table-diff" class="diff-text" style="color: var(--danger);">+0.00s</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="btn-container">
        <button id="start-btn" onclick="toggleSequence()">START</button>
    </div>

    <div class="watermark">DESIGNED BY UDAYANA ANANTH KUMAR</div>

    <script>
        let audioCtx, analyser, data;
        let et = 0, st = 0, active = false;
        const canvas = document.getElementById('wave-canvas');
        const ctx = canvas.getContext('2d');

        function resize() {
            canvas.width = canvas.clientWidth;
            canvas.height = canvas.clientHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        async function toggleSequence() {
            if (!audioCtx) {
                try {
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    const source = audioCtx.createMediaStreamSource(stream);
                    analyser = audioCtx.createAnalyser();
                    analyser.fftSize = 256;
                    source.connect(analyser);
                    data = new Uint8Array(analyser.frequencyBinCount);
                } catch (err) {
                    alert("Microphone access is required.");
                    return;
                }
            }

            active = !active;
            const btn = document.getElementById('start-btn');
            btn.innerText = active ? "STOP" : "START";
            btn.classList.toggle('active', active);
            document.getElementById('duality-status').innerText = active ? "WAVE OBSERVATION" : "PARTICLE STATE";
            
            if (active) {
                if (audioCtx.state === 'suspended') audioCtx.resume();
                loop();
            } else {
                drawDuality(0);
            }
        }

        function drawDuality(signal) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if (active) {
                // Real-time 3D Sine Wave
                ctx.strokeStyle = '#00ffcc';
                ctx.lineWidth = 3;
                ctx.beginPath();
                for (let x = 0; x < canvas.width; x++) {
                    const y = canvas.height/2 + Math.sin(x * 0.05 + et * 10) * (signal/2);
                    ctx.lineTo(x, y);
                }
                ctx.stroke();
            } else {
                // Static Particle Points (Quantum Grain)
                for (let i = 0; i < 30; i++) {
                    const posX = (i * (canvas.width / 30)) + (canvas.width/60);
                    const posY = canvas.height/2 + (Math.random() * 4 - 2); 
                    ctx.fillStyle = '#ffea00';
                    ctx.beginPath();
                    ctx.arc(posX, posY, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
        }

        function loop() {
            if (!active) return;
            analyser.getByteFrequencyData(data);
            let sum = 0;
            for(let i = 0; i < data.length; i++) sum += data[i];
            let avg = sum / data.length;
            let signal = avg * parseFloat(document.getElementById('sens-knob').value);
            
            let noisePercent = Math.min(100, (signal / 120) * 100);
            document.getElementById('fill').style.width = noisePercent + '%';
            document.getElementById('db-label').innerText = Math.round(noisePercent) + '%';

            let rpm = signal > 10 ? Math.min(999, Math.floor(signal * 8)) : 0;
            document.getElementById('rpm-val').innerText = rpm.toString().padStart(3, '0');

            let factor = 1 + (rpm / 2000); 
            et += 0.016; 
            st += 0.016 * factor;

            document.getElementById('et').innerText = et.toFixed(2);
            document.getElementById('st').innerText = st.toFixed(2);
            document.getElementById('warp-factor').innerText = "LORENTZ FACTOR: " + factor.toFixed(3);
            
            document.getElementById('table-et').innerText = et.toFixed(2) + "s";
            document.getElementById('table-st').innerText = st.toFixed(2) + "s";
            document.getElementById('table-diff').innerText = "+" + (st - et).toFixed(2) + "s";
            document.getElementById('table-status').innerText = rpm > 500 ? "HIGH VELOCITY" : (rpm > 10 ? "DILATING" : "IDLE");

            // Update 3D Sphere Rotation
            document.getElementById('sphere').style.transform = `rotateY(${(st * 100) % 360}deg) rotateX(${(rpm / 5) % 360}deg)`;
            document.getElementById('needle').style.transform = `rotate(${rpm}deg)`;

            drawDuality(signal);
            requestAnimationFrame(loop);
        }
        drawDuality(0);
    </script>
</body>
</html>
